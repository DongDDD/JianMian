<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!--主要I是强制让文档的宽度与设备宽度保持1:1，最大宽度1.0，禁止屏幕缩放。-->
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <!--这个也是iphone私有标签，允许全屏浏览。-->
    <meta content="yes" name="apple-mobile-web-app-capable">
    <!--iphone的私有标签，iphone顶端状态条的样式。-->
    <meta content="yes" name="apple-touch-fullscreen"/>
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <!--禁止数字自动识别为电话号码，这个比较有用，因为一串数字在iphone上会显示成蓝色，样式加成别的颜色也是不生效的。-->
    <meta content="telephone=no" name="format-detection">
    <!--禁止email识别-->
    <meta content="email=no" name="format-detection">
    <meta content="initial-dpr=2" name="flexible"/>
    <title>Title</title>
    <link rel="stylesheet" href="../css/muse-ui.css">
    <link rel="stylesheet" href="../css/material-icons.css">
    <link rel="stylesheet" href="../css/main.css" />
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.14&key=d8494573dfc17e6efe99774447611ced&plugin=AMap.ToolBar"></script>
    <script src="../js/flexible.debug.js"></script>
    <script src="../js/flexible_css.debug.js"></script>
    <style lang="less" type="text/less">
        body {
            font-family: PingFang-SC-Medium;
            font-weight: 500;
        }
        .line {
            border-top: 0.03rem solid rgba(230, 230, 230, 1);
        }
        .container {
            padding: 0;
        }
        .amap-marker-label{
            border: none;
            box-shadow:0px 8px 9px 1px rgba(128,128,128,0.24);
        }
        #wrapper{
            background: #ffffff;
            color: #999999;
            header{
                display: flex;
                justify-content: space-between;
                padding: 0.48rem 0.56rem;
                .avatar{
                    margin-right: 0.4rem;
                    width: 1.6rem;
                    img{
                        width: 100%;
                    }
                }
                .contain{
                    display: flex;
                    flex-direction: column;
                    align-self: center;
                    justify-content: space-between;
                    width: 6.5rem;
                    font-size: 0.37rem;
                    .c-name{
                        margin-bottom: 0.1rem;
                        font-family: MicrosoftYaHei;
                        color:#333333;
                    }
                    .credit{
                        display: flex;
                        span{
                            align-self: center;
                            margin-right:0.02rem;
                        }
                        div{
                            align-self: center;
                            img{
                                width: 0.4rem;
                                margin-top: 0.15rem;
                                margin-left:0.02rem;
                            }
                        }
                    }
                }
                .icon-footer{
                    align-self: center;
                    width: 0.18rem;
                    img{
                        width: 100%
                    }
                }
            }
            #searchBar{
                display: flex;
                text-align: center;
                height: 1.22rem;
                font-size:0.4rem;
                .isFixed{
                    position:fixed;
                    top:0;
                    height: 1.22rem;
                    z-index:100;
                    color: #999999;
                    background:#fff;
                    border-bottom: 1px solid rgba(230, 230, 230, 1);
                }
                ul {
                    display: flex;
                    width: 100%;
                    border-top: 0.03rem solid rgba(230, 230, 230, 1);
                    .toggle{
                        color: #24BFFF;
                    }
                    li {
                        display: flex;
                        justify-content:center;
                        align-items:center;
                        align-self: center;
                        width: 50%;
                        height:100%;
                    }
                }

            }
            .nav-light{
                display: flex;
                justify-content: space-around;
                text-align: center;
                width: 100%;
                div{
                    width: 0.37rem;
                    border-top: 1px solid #24BFFF;
                }
                span{
                    width: 0.37rem;
                }
            }
            #sale-task{
                .open-left-enter-active, .open-left-leave-active {
                    transform: translate3d(0,0,0);
                    transition: all 0.3s;
                }
                .open-left-enter, .open-left-leave-to /* .fade-leave-active below version 2.1.8 */ {
                    transform: translate3d(-100%,0,0);
                }
                .task{
                    display: flex;
                    flex-direction: column;
                    padding: 0.66rem 0.53rem;
                    .task-name{
                        margin-bottom: 0.3rem;
                        font-family: PingFang-SC-Bold;
                        color:#333333;
                        font-size: 0.48rem;
                    }
                    .unit{
                        margin-bottom: 0.26rem;
                        color:#FF5150;
                        font-size: 0.66rem;
                        span{
                            margin-left: 0.26rem;
                            color: #999999;
                            font-size: 0.32rem;
                        }
                    }
                    .label{
                        ul{
                            display: flex;
                            color: #999999;
                            font-size: 0.32rem;
                            li{
                                margin-right: 0.26rem;
                                padding:0 0.24rem;
                                border:1px solid #CCCCCC;
                                border-radius: 0.1rem
                            }
                        }
                    }
                }
                .require{
                    padding: 0.66rem 0.53rem;
                    font-size: 0.37rem;
                    p:nth-last-child(1){
                        margin-bottom: 0;
                    }
                    p{
                        margin-bottom: 0.48rem;
                        span{
                            margin-left: 0.4rem;
                            color: #333333;
                        }
                    }
                    div{
                        ul{
                            margin-left: 0.4rem;
                            display: inline;
                            color: #333333;
                            li:nth-last-child(1){
                                span{
                                    display: none;
                                }
                            }
                            li{
                                display: inline-block;
                            }
                        }
                    }
                }
                .product{
                    padding: 0.66rem 0.53rem 0 0.53rem;
                    color:#333333;
                    span{
                        font-family: PingFang-SC-Bold;
                        font-size: 0.42rem;
                        color: #333333;
                    }
                    div{
                        margin-top:0.53rem;
                        color: #24BFFF;
                        font-size: 0.37rem;
                    }
                    p{
                        font-size: 0.37rem;
                        margin-bottom: 0.1rem;
                    }
                }
                .describe{
                    padding: 0.66rem 0.53rem;
                    span{
                        font-family: PingFang-SC-Bold;
                        font-size: 0.42rem;
                        color: #333333;
                    }
                    p{
                        margin-top: 0.66rem;
                    }
                    /*#output {
                        position: absolute;
                        top:0;
                        left:0;
                        width: 100%;
                        height: 13rem;
                        text-align: center;
                        img{
                            position: absolute;
                            top:50%;
                            left: 50%;
                            transform: translate3d(-50%,-50%,0);
                            z-index: 100;
                            width: 100%;
                            height: auto;
                        }
                    }*/
                }
                .bottom{
                    display: flex;
                    justify-content: center;
                    height: 1.2rem;
                    text-align: center;
                    color:#999999;
                    font-size: 0.26rem;
                    span{
                        align-self: center;
                        width: 1.73rem;
                        border-top: 1px solid #D9D9D9;
                    }
                }
            }
            #job-task{
                .open-left-enter-active, .open-left-leave-active {
                    transform: translate3d(0,0,0);
                    transition: all 0.3s;
                }
                .open-left-enter, .open-left-leave-to /* .fade-leave-active below version 2.1.8 */ {
                    transform: translate3d(-100%,0,0);
                }
                .task{
                    display: flex;
                    flex-direction: column;
                    padding: 0.66rem 0.53rem;
                    .task-name{
                        margin-bottom: 0.3rem;
                        font-family: PingFang-SC-Bold;
                        color:#333333;
                        font-size: 0.48rem;
                    }
                    .unit{
                        margin-bottom: 0.1rem;
                        color:#FF5150;
                        font-size: 0.66rem;
                        span{
                            margin-left: 0.26rem;
                            color: #999999;
                            font-size: 0.32rem;
                        }
                    }
                    .label{
                        ul{
                            display: flex;
                            color: #999999;
                            font-size: 0.32rem;
                            li{
                                margin-right: 0.26rem;
                                padding:0 0.24rem;
                                border:1px solid #CCCCCC;
                                border-radius: 0.1rem
                            }
                        }
                    }
                }
                .require{
                    padding: 0.66rem 0.53rem;
                    font-size: 0.37rem;
                    p:nth-last-child(1){
                        margin-bottom: 0;
                    }
                    p{
                        margin-bottom: 0.48rem;
                        span{
                            margin-left: 0.4rem;
                            color: #333333;
                        }
                    }
                    div{
                        ul{
                            margin-left: 0.4rem;
                            display: inline;
                            color: #333333;
                            li:nth-last-child(1){
                                span{
                                    display: none;
                                }
                            }
                            li{
                                display: inline-block;
                            }
                        }
                    }
                }
                .describe{
                    padding: 0.66rem 0.53rem;
                    span{
                        font-family: PingFang-SC-Bold;
                        font-size: 0.42rem;
                        color: #333333;
                    }
                    p{
                        margin-top: 0.66rem;
                    }
                }
                .map{
                    position: relative;
                    padding:0.69rem 0 0.88rem 0;
                    p{
                        margin:0 0 0.53rem 0.53rem;
                        color: #333333;
                        font-size: 0.42rem;
                        font-family: PingFang-SC-Bold;
                    }
                }
                .bottom{
                    position:absolute;
                    bottom: -1rem;
                    left: 0;
                    display: flex;
                    justify-content: center;
                    height: 1.2rem;
                    width: 100%;
                    color:#999999;
                    font-size: 0.26rem;
                    text-align: center;
                    span{
                        align-self: center;
                        width: 1.73rem;
                        border-top: 1px solid #D9D9D9;
                    }
                }
            }
            #credit{
                .open-right-enter-active, .open-right-leave-active {
                    transform: translate3d(0,0,0);
                    transition: all 0.3s 0.06s;
                }
                .open-right-enter, .open-right-leave-to /* .fade-leave-active below version 2.1.8 */ {
                    transform: translate3d(100%,0,0);
                }
                .credit-lists{
                    padding: 0.66rem 0.53rem 0 0.53rem;
                    overflow-y: auto;
                    overflow-x: hidden;
                    -webkit-overflow-scrolling: touch;
                    .contain{
                        display: flex;
                        margin-bottom: 0.37rem;
                        font-size: 0.4rem;
                        .avator{
                            margin-right: 0.34rem;
                            width: 0.88rem;
                            height:0.88rem;
                            overflow:hidden
                            img{
                                border-radius: 50%;
                            }
                        }
                        .user-name{
                            align-self: flex-start;
                            width: 6.56rem;
                            color: #333333;
                            p{
                                font-size: 0.32rem;
                                color: #999999;
                            }
                        }
                        .num{
                            align-self: flex-start;
                            color:#24BFFF;
                        }
                    }
                    .remark{
                        margin-bottom: 0.66rem;
                        color: #333333;
                        font-size: 0.37rem;
                        margin-left: 1.23rem;
                    }
                }
            }
            .mu-carousel{
            position:relative;
            width:100%;
            height:100%;
            .mu-carousel-item{
                position:absolute;
                top:50%;
                left:50%;
                transform:translate(-50%,-50%);
                width:90%;
                height:90%;
                img{
                    position:absolute;
                    top:50%;
                    left:50%;
                    transform:translate(-50%,-50%);
                    width:90%;
                }
            }
        }
        }
        .wrapper{
            position:relative;
            width: 9.5rem;
            height: 1.7rem;
            padding: 0.32rem;
        }
        .note{
            display: flex;
            justify-content: space-between;
        }
        .main{
            align-self: center
        }
        .company{
            color: #484848!important;
            font-size: 0.37rem!important;
            margin-bottom: 0.22rem!important;
            margin-left: 0!important;
        }
        .address{
            font-size: 0.34rem!important;
            color:#6B6B6B!important;
            margin: 0!important
        }
        .goMap{
            width: 0.18rem;
            align-self: center;
        }
        .mu-elevation-1{
            -webkit-box-shadow:none;
            box-shadow:none;
        }
        .dialog-open {
            -webkit-overflow-scrolling:touch;
            position: fixed;
            width: 100%;
        }

    </style>
</head>
<body>
<div id="wrapper" style="visibility:hidden">
    <div>
        <div class="line"></div>
        <header style="display: none" v-show="initialize" @click="clickCompanyDetails">
        <span class="avatar">
            <img v-if="this.detail.company" :src="this.detail.company.logo_path" alt="">
        </span>
        <span class="contain">
            <p class="c-name" v-if="this.detail.company">{{this.detail.company.company_name}}</p>
            <span class="credit" v-show="level>0">
                <span>信用</span>
                <div>
                    <img id="level" v-for="item in level" :src="level1" alt="">
                </div>
            </span>
        </span>
            <span class="icon-footer">
            <img src="../images/icon_return@2x.png" alt="">
        </span>
        </header>
        <div style="height: 0.24rem;background: #F5F5F6;"><br/></div>
        <div id="searchBar" >
            <ul :class="searchBarFixed == true ? 'isFixed' :''">
                <li :class="task == true ? 'toggle' :''" style="border-right: 1px solid rgba(235,235,235,1);" @click="handleTask">任务描述</li>
                <li :class="credit == true ? 'toggle' :''" @click="handleCredit">信誉评价</li>
            </ul>
        </div>
        <div class="nav-light">
            <div v-show="task"></div>
            <span v-show="credit || task"></span>
            <div v-show="credit"></div>
        </div>
        <div class="line"></div>
        <div id="sale-task" v-show="this.detail.payment_method === 1">
            <transition name="open-left">
                <div v-show="task">
                    <div class="task">
                        <span class="task-name" v-if="this.detail">{{this.detail.task_title}}</span>
                        <span class="unit" v-if="this.detail">{{this.detail.payment_money}}<span>{{this.detail.unit}}</span></span>
                        <span class="label">
                            <ul>
                                <li>即结</li>
                                <li>签合同</li>
                            </ul>
                        </span>
                    </div>
                    <div class="line" style="margin: 0 0.53rem;"></div>
                    <div class="require">
                        <p>招募人数：<span v-if="this.detail">{{this.detail.quantity_max}}</span></p>
                        <p>工作城市：<span v-if="this.detail.city">{{this.detail.city.city_name}}</span></p>
                        <div>适合行业：<ul><li v-for="item in this.detail.industry">{{item.name}}<span>/</span></li></ul></div>
                    </div>
                    <div class="line" style="margin:0 0.53rem;"></div>
                    <div class="product">
                        <span>产品描述</span>
                        <div v-if="this.detail.goods">产品名称：{{this.detail.goods.goods_title}}</div>
                        <div v-if="this.detail.goods" style="margin-bottom: 0.53rem">产品价格：{{this.detail.goods.goods_price}}元</div>
                        <p v-if="this.detail.goods" style="margin-bottom: 0.72rem">{{this.detail.goods.description}}</p>
                    </div>
                    <div class="line" style="margin:0 0.53rem;"></div>
                    <div class="describe" v-show="this.detail.video">
                        <span>产品视频</span>
                        <div style="text-align: center;margin-top: 0.66rem;position: relative">
                            <video id="video" width="90%" style="border-radius: 0.33rem" controls preload="auto" x5-video-player-type="h5" v-if="this.detail.video" :poster="this.detail.video.cover">
                                <source :src="this.detail.video && this.detail.video.file_path">
                            </video>
                        </div>
                    </div>
                    <div class="line" style="margin:0 0.53rem;"></div>
                    <div class="describe" v-if="this.detail.images">
                        <span>产品图片</span>
                        <ul style="width: 100%;margin-top: 0.66rem;">
                            <li style="display: inline-block;width: 2.8rem;height:2.8rem;line-height:2.8rem;overflow:hidden;background:#000;text-align:center;margin-right: 0.12rem;" v-for="(item,index) in this.detail.images"><img :src="item.file_path" alt="" style="width:100%;vertical-align:middle;" @click="openSimpleDialog(index)"></li>
                        </ul>
                    </div>
                    <div class="bottom">
                        <span></span>
                        <p style="display:inline-block;vertical-align:middle;align-self: center;margin: 0 0.34rem">已经到底啦，再往上逛逛吧</p>
                        <span></span>
                    </div>
                </div>
            </transition>
        </div>
        <div id="job-task" v-show="this.detail.payment_method !== 1">
            <transition name="open-left">
                <div v-show="task" style="position: relative">
                    <div class="task">
                        <span class="task-name" v-if="this.detail">{{this.detail.task_title}}</span>
                        <span class="unit" v-if="this.detail">{{this.detail.payment_money}}<span v-if="this.detail">{{this.detail.unit}}</span></span>
                        <span class="label">
                        <ul>
                            <li>完工结</li>
                            <li>签合同</li>
                        </ul>
                    </span>
                    </div>
                    <div class="line" style="margin: 0 0.53rem;"></div>
                    <div class="require">
                        <p>招募人数：<span v-if="this.detail">{{this.detail.quantity_max}}</span></p>
                        <p>工作城市：<span v-if="this.detail.city">{{this.detail.city.city_name}}</span></p>
                        <div>适合行业：<ul><li v-for="item in this.detail.industry">{{item.name}}<span>/</span></li></ul></div>
                    </div>
                    <div class="line" style="margin:0 0.53rem;"></div>
                    <div class="describe">
                        <span>工作描述</span>
                        <p style="color:#333333;line-height: 0.69rem;font-size: 0.37rem" v-if="this.detail.description">
                            {{this.detail.description}}
                        </p>
                    </div>
                    <div class="line" style="margin:0 0.53rem;" v-if="this.detail.address"></div>
                    <div class="map" v-if="this.detail.address">
                        <p>工作地址</p>
                        <div style="margin: 0 0.29rem 0.37rem 0.53rem">
                            <img src="../images/didian2@2x.png" alt="" style="width: 0.34rem;">
                            <span>{{this.detail.address}}</span>
                        </div>
                        <div v-if="this.detail.latitude && this.detail.longitude" id="mapContainer" style="height: 7rem;" @click="clickCompanyToAMap"></div>
                    </div>
                    <div class="bottom">
                        <span></span>
                        <p style="display:inline-block;vertical-align:middle;align-self: center;margin: 0 0.34rem">已经到底啦，再往上逛逛吧</p>
                        <span></span>
                    </div>
                </div>
            </transition>
        </div>
        <div id="credit">
            <transition name="open-right">
                <mu-paper v-show="credit" :z-depth="1" class="demo-loadmore-wrap">
                    <mu-container ref="container" class="demo-loadmore-content">
                        <mu-load-more :loading="loading" @load="load" :loaded-all="over" :loading-text="text">
                            <div class="credit-lists" v-for="item in this.record.data">
                                <div class="list">
                                    <div class="contain">
                                        <span class="avator"><img :src="item.user.avatar" alt="" width="100%" height="100%"></span>
                                        <span class="user-name">{{item.user.nickname}}<p>任务：{{item.task.task_title}}</p></span>
                                        <span class="num">{{item.reputation}}.0分</span>
                                    </div>
                                    <div class="remark">
                                        <p>{{item.description}}</p>
                                    </div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </mu-load-more>
                    </mu-container>
                </mu-paper>
            </transition>
        </div>
    </div>
    <div style="position: fixed;top:0;left:0;background:#000;width: 100%;height: 100%;z-index:1000;text-align:center" v-if="openSimple" @click="close">
        <mu-carousel hide-indicators hide-controls interval=6000 :active="bigImg">
            <mu-carousel-item v-for="(item,index) in this.detail.images">
                <img :src="item.file_path">
            </mu-carousel-item>
        </mu-carousel>
    </div>
</div>
</body>
<script src="../js/vue.js"></script>
<script src="../js/axios.min.js"></script>
<script src="../js/muse-ui.js"></script>
<script src="../js/less.min.js"></script>
<script>
    var vue = new Vue({
        el: '#wrapper',
        data:{
            detail:{},
            record:{},
            describeList: [
                {label: "即结",id:'1'},
                {label: "签合同",id:'2'},
            ],
            loading: false,
            num:10,
            task:true,
            credit:false,
            initialize: false,
            searchBarFixed:false,
            token:'',
            page:1,
            over:false,
            text:'正在加载',
            level:0,
            level1:"../images/x.png",
            level2:"../images/z.png",
            level3:"../images/mission3@2x.png",
            level4:"../images/mission@2x.png",
            openSimple: false,
            bigImg: null,
        },
        mounted(){
            setTimeout(function () {
                this.initialize = true;
            }.bind(this));
            document.addEventListener('scroll', this.handleScroll);
            ModalHelper = ((bodyCls) => {
                let scrollTop;
                return {
                    afterOpen: function () {
                        scrollTop = document.scrollingElement.scrollTop;
                        document.body.classList.add(bodyCls);
                        document.body.style.top = -scrollTop + 'px';
                    },
                    beforeClose: function () {
                        document.body.classList.remove(bodyCls);
                        document.scrollingElement.scrollTop = scrollTop;
                    },
                };
            })('dialog-open');
        },
        methods:{
            handleScroll () {
                var obj = document.getElementById('searchBar');
                var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
                let offsetTop = obj.offsetTop;
                scrollTop > offsetTop ? this.searchBarFixed = true : this.searchBarFixed = false;
            },
            destroyed () {
                window.removeEventListener('scroll', this.handleScroll); // 离开页面 关闭监听 不然会报错
            },
            handleTask() {
                this.task = true;
                this.credit = false;
            },
            handleCredit(){
                if(this.token){
                console.log(this.token)
                    axios.get('http://produce.jmzhipin.com/api/task/comment/paginate?company_id=' + this.detail.company.company_id, {
                        headers: {
                            'x-access-sign': '585c84aca67b58e000364309783e31e6',
                            'Authorization': this.token,
                        }
                    })
                        .then(function (res) {
                            var jsonData = JSON.stringify(res.data);
                            this.record = JSON.parse(jsonData);
                            this.page = this.record.current_page;
                            console.log(this.record)
                            console.log(JSON.parse(this.record.data))
                        }.bind(this))
                        .catch(function (error) {
                            console.log(error);
                        });
                }
                this.task = false;
                this.credit = true;
                var video = document.getElementById('video');
                video.pause();
            },
            clickCompanyDetails(){
                window.webkit.messageHandlers.aaa.postMessage(this.detail.company.company_id);
            },
            clickCompanyToAMap(){
                window.webkit.messageHandlers.aaa.postMessage()
            },
            load() {
                this.loading = true;
                this.page = this.page + 1;
                axios.get('http://produce.jmzhipin.com/api/task/comment/paginate?company_id=' +  this.detail.company.company_id + '&page=' + this.page, {
                    headers: {
                        'x-access-sign': '585c84aca67b58e000364309783e31e6',
                        'Authorization': this.token,
                    }
                })
                    .then(function (res) {
                        if(res.data.last_page < this.page){
                            this.text = '已加载全部！';
                            setTimeout(() => {
                                this.over = true;
                            }, 1500);
                        }else{
                            var length = res.data.data.length;
                            for(var i = 0;i<length; i++){
                                this.record.data.push(res.data.data[i])
                            }
                            this.page = res.data.current_page;
                            setTimeout(() => {
                                this.loading = false;
                            }, 2000);
                            console.log(this.record);
                        }
                        if(res.data.code !== 200){
                            this.already = true;
                        }
                    }.bind(this))
                    .catch(function (error) {
                        console.log(error);
                    });
            },
            openSimpleDialog (index) {
                this.openSimple = true;
                this.bigImg = index;
                ModalHelper.afterOpen();
            },
            leveling(){
                var img = document.getElementById('level');
                console.log(img)
                if(this.detail.company.reputation){
                    if(4 <= this.detail.company.reputation && this.detail.company.reputation <= 10){
                        this.level = 1;
                        img.src = this.level1
                    }
                    if(11 <= this.detail.company.reputation && this.detail.company.reputation <= 40){
                        this.level = 2;
                        img.src = this.level1
                    }
                    if(41 <= this.detail.company.reputation && this.detail.company.reputation <= 90){
                        this.level = 3;
                        img.src = this.level1
                    }
                    if(91 <= this.detail.company.reputation && this.detail.company.reputation <= 150){
                        this.level = 4;
                        img.src = this.level1
                    }
                    if(151 <= this.detail.company.reputation && this.detail.company.reputation <= 250){
                        this.level = 5;
                        img.src = this.level1
                    }
                    if(251 <= this.detail.company.reputation && this.detail.company.reputation <= 500){
                        this.level = 1;
                        img.src = this.level2
                    }
                    if(501 <= this.detail.company.reputation && this.detail.company.reputation <= 1000){
                        this.level = 2;
                        img.src = this.level2
                    }
                    if(1001 <= this.detail.company.reputation && this.detail.company.reputation <= 2000){
                        this.level = 3;
                        img.src = this.level2
                    }
                    if(2001 <= this.detail.company.reputation && this.detail.company.reputation <= 5000){
                        this.level = 4;
                        img.src = this.level2
                    }
                    if(5001 <= this.detail.company.reputation && this.detail.company.reputation <= 10000){
                        this.level = 5;
                        img.src = this.level2
                    }
                    if(10001 <= this.detail.company.reputation && this.detail.company.reputation <= 20000){
                        this.level = 1;
                        img.src = this.level3
                    }
                    if(20001 <= this.detail.company.reputation && this.detail.company.reputation <= 50000){
                        this.level = 2;
                        img.src = this.level3
                    }
                    if(50001 <= this.detail.company.reputation && this.detail.company.reputation <= 100000){
                        this.level = 3;
                        img.src = this.level3
                    }
                    if(100001 <= this.detail.company.reputation && this.detail.company.reputation <= 200000){
                        this.level = 4;
                        img.src = this.level3
                    }
                    if(200001 <= this.detail.company.reputation && this.detail.company.reputation <= 500000){
                        this.level = 5;
                        img.src = this.level3
                    }
                    if(500001 <= this.detail.company.reputation && this.detail.company.reputation <= 1000000){
                        this.level = 1;
                        img.src = this.level4
                    }
                    if(1000001 <= this.detail.company.reputation && this.detail.company.reputation <= 2000000){
                        this.level = 2;
                        img.src = this.level4
                    }
                    if(2000001 <= this.detail.company.reputation && this.detail.company.reputation <= 5000000){
                        this.level = 3;
                        img.src = this.level4
                    }
                    if(5000001 <= this.detail.company.reputation && this.detail.company.reputation <= 10000000){
                        this.level = 4;
                        img.src = this.level4
                    }
                    if(this.detail.company.reputation > 1000000){
                        this.level = 5;
                        img.src = this.level4
                    }
                }
            },
            init(){
                var longitude = this.detail.longitude;
                var latitude = this.detail.latitude;
                var name = this.detail.company.company_name;
                var area = this.detail.address;
                var map = new AMap.Map('mapContainer', {
                    zoom: 15,
                    center:[longitude,latitude],
                    offset: new AMap.Pixel(0, 0),
                    dragEnable:false,
                    zoomEnable:true
                });
                var img = '<img style="width: 100%" src="../images/icon_return@2x.png" alt="">';
                var triangle = '<div style="position: absolute;bottom: -0.45rem; left: 50%;transform: translateX(-70%);border: 0.2rem solid transparent;border-top: 0.2rem solid #fff;"></div>';
                function createInfoWindow(img,triangle,name,area){
                    var info = document.createElement('div');
                    var wrapper = document.createElement('div');
                    wrapper.className = 'wrapper';
                    var note = document.createElement('div');
                    note.className = 'note';
                    var main = document.createElement('div');
                    main.className = 'main';
                    var company = document.createElement('p');
                    company.className = 'company';
                    company.innerHTML = name;
                    main.appendChild(company);
                    var address = document.createElement('p');
                    address.className = 'address';
                    address.innerHTML = area;
                    main.appendChild(address);
                    note.appendChild(main);
                    var goMap = document.createElement('div');
                    goMap.className = 'goMap';
                    goMap.innerHTML = img;
                    note.appendChild(goMap);
                    wrapper.innerHTML = triangle;
                    wrapper.appendChild(note);
                    info.appendChild(wrapper);
                    return info.innerHTML
                }
                // 创建一个自定义内容的 infowindow 实例
                marker = new AMap.Marker({
                    map:map,
                    position:[longitude,latitude],
                    label: {
                        offset: new AMap.Pixel(-169, -77),//修改label相对于maker的位置
                        content: createInfoWindow(img,triangle,name,area)
                    }
                });
            },
            close(){
                this.openSimple = false;
                ModalHelper.beforeClose()
            }
        },
        watch:{
            detail:function () {
                this.$nextTick(function(){
                    document.getElementById('wrapper').style.visibility = 'visible';
                    if(vue.detail.payment_method !== 1 && this.detail.latitude && this.detail.longitude){
                        vue.init();
                    }
                    vue.leveling();
                })
            }
        }
    });

    function showInfoFromJava(item,token) {
        vue.detail = JSON.parse(item);
        vue.token = token;
        console.log(token)
    }

    /*if(vue.detail){
        function taskDataLoading(){
            Javascript:aaa.taskDataLoading()
        }
        this.taskDataLoading();

    }*/

</script>
</html>