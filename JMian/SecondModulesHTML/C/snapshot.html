<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!--主要I是强制让文档的宽度与设备宽度保持1:1，最大宽度1.0，禁止屏幕缩放。-->
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <!--这个也是iphone私有标签，允许全屏浏览。-->
    <meta content="yes" name="apple-mobile-web-app-capable">
    <!--iphone的私有标签，iphone顶端状态条的样式。-->
    <meta content="yes" name="apple-touch-fullscreen"/>
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <!--禁止数字自动识别为电话号码，这个比较有用，因为一串数字在iphone上会显示成蓝色，样式加成别的颜色也是不生效的。-->
    <meta content="telephone=no" name="format-detection">
    <!--禁止email识别-->
    <meta content="email=no" name="format-detection">
    <meta content="initial-dpr=2" name="flexible"/>
    <title>Title</title>
    <link rel="stylesheet" href="../css/muse-ui.css">
    <link rel="stylesheet" href="../css/material-icons.css">
    <link rel="stylesheet" href="../css/main.css" />
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.14&key=d8494573dfc17e6efe99774447611ced&plugin=AMap.ToolBar"></script>
    <script src="../js/flexible.debug.js"></script>
    <script src="../js/flexible_css.debug.js"></script>
    <style lang="less" type="text/less">
        body {
            font-family: PingFang-SC-Medium;
            font-weight: 500;
        }
        .line {
            border-top: 0.03rem solid rgba(230, 230, 230, 1);
        }
        .container {
            padding: 0;
        }
        .amap-marker-label{
            border: none;
            box-shadow:0px 8px 9px 1px rgba(128,128,128,0.24);
        }
        #wrapper{
            background: #ffffff;
            color: #999999;
            header{
                display: flex;
                justify-content: space-between;
                padding: 0.48rem 0.56rem;
                .avatar{
                    margin-right: 0.4rem;
                    width: 1.6rem;
                    img{
                        width: 100%;
                    }
                }
                .contain{
                    display: flex;
                    flex-direction: column;
                    align-self: center;
                    justify-content: space-between;
                    width: 6.5rem;
                    font-size: 0.37rem;
                    .c-name{
                        margin-bottom: 0.1rem;
                        font-family: MicrosoftYaHei;
                        color:#333333;
                    }
                    .credit{
                        display: flex;
                        span{
                            margin-right: 0.4rem;
                        }
                        img{
                            width: 0.58rem;
                        }
                    }
                }
                .icon-footer{
                    align-self: center;
                    width: 0.18rem;
                    img{
                        width: 100%
                    }
                }
            }
            .detail{
                padding: 0.29rem 0.5rem;
                font-size: 0.34rem;
                span:nth-child(1){
                    color: #999999;
                }
                span:nth-child(2){
                    color: #24BFFF;
                    margin-left: 0.26rem;
                }
            }
            #sale-task{
                .task{
                    display: flex;
                    flex-direction: column;
                    padding: 0.66rem 0.53rem;
                    .task-name{
                        margin-bottom: 0.3rem;
                        font-family: PingFang-SC-Bold;
                        color:#333333;
                        font-size: 0.48rem;
                    }
                    .unit{
                        margin-bottom: 0.26rem;
                        color:#FF5150;
                        font-size: 0.66rem;
                        span{
                            margin-left: 0.26rem;
                            color: #999999;
                            font-size: 0.32rem;
                        }
                    }
                    .label{
                        ul{
                            display: flex;
                            color: #999999;
                            font-size: 0.32rem;
                            li{
                                margin-right: 0.26rem;
                                padding:0 0.24rem;
                                border:1px solid #CCCCCC;
                                border-radius: 0.1rem
                            }
                        }
                    }
                }
                .require{
                    padding: 0.66rem 0.53rem;
                    font-size: 0.37rem;
                    p:nth-last-child(1){
                        margin-bottom: 0;
                    }
                    p{
                        margin-bottom: 0.48rem;
                        span{
                            margin-left: 0.4rem;
                            color: #333333;
                        }
                    }
                    div{
                        margin-bottom: 0.48rem;
                        ul{
                            margin-left: 0.4rem;
                            display: inline;
                            color: #333333;
                            li:nth-last-child(1){
                                span{
                                    display: none;
                                }
                            }
                            li{
                                display: inline-block;
                            }
                        }
                    }
                }
                .product{
                    padding: 0.66rem 0.53rem 0 0.53rem;
                    color:#333333;
                    span{
                        font-family: PingFang-SC-Bold;
                        font-size: 0.42rem;
                        color: #333333;
                    }
                    div{
                        margin-top:0.53rem;
                        color: #24BFFF;
                        font-size: 0.37rem;
                    }
                    p{
                        font-size: 0.37rem;
                        margin-bottom: 0.1rem;
                    }
                }
                .describe{
                    padding: 0.66rem 0.53rem;
                    span{
                        font-family: PingFang-SC-Bold;
                        font-size: 0.42rem;
                        color: #333333;
                    }
                    p{
                        margin-top: 0.66rem;
                    }
                }
                .bottom{
                    display: flex;
                    justify-content: center;
                    height: 1.2rem;
                    margin-bottom: 1.33rem;
                    text-align: center;
                    color:#999999;
                    font-size: 0.26rem;
                    span{
                        align-self: center;
                        width: 1.73rem;
                        border-top: 1px solid #D9D9D9;
                    }
                }
            }
            #job-task{
                .task{
                    display: flex;
                    flex-direction: column;
                    padding: 0.66rem 0.53rem;
                    .task-name{
                        margin-bottom: 0.3rem;
                        font-family: PingFang-SC-Bold;
                        color:#333333;
                        font-size: 0.48rem;
                    }
                    .unit{
                        margin-bottom: 0.1rem;
                        color:#FF5150;
                        font-size: 0.66rem;
                        span{
                            margin-left: 0.26rem;
                            color: #999999;
                            font-size: 0.32rem;
                        }
                    }
                    .label{
                        ul{
                            display: flex;
                            color: #999999;
                            font-size: 0.32rem;
                            li{
                                margin-right: 0.26rem;
                                padding:0 0.24rem;
                                border:1px solid #CCCCCC;
                                border-radius: 0.1rem
                            }
                        }
                    }
                }
                .require{
                    padding: 0.66rem 0.53rem;
                    font-size: 0.37rem;
                    p:nth-last-child(1){
                        margin-bottom: 0;
                    }
                    p{
                        margin-bottom: 0.48rem;
                        span{
                            margin-left: 0.4rem;
                            color: #333333;
                        }
                    }
                    div{
                        ul{
                            margin-left: 0.4rem;
                            display: inline;
                            color: #333333;
                            li:nth-last-child(1){
                                span{
                                    display: none;
                                }
                            }
                            li{
                                display: inline-block;
                            }
                        }
                    }
                }
                .describe{
                    padding: 0.66rem 0.53rem;
                    span{
                        font-family: PingFang-SC-Bold;
                        font-size: 0.42rem;
                        color: #333333;
                    }
                    p{
                        margin-top: 0.66rem;
                    }
                }
                .map{
                    position: relative;
                    padding:0.69rem 0 0.88rem 0;
                    p{
                        margin:0 0 0.53rem 0.53rem;
                        color: #333333;
                        font-size: 0.42rem;
                        font-family: PingFang-SC-Bold;
                    }
                }
                .bottom{
                    position:absolute;
                    bottom: -0.1rem;
                    left: 0;
                    display: flex;
                    justify-content: center;
                    height: 1.2rem;
                    width: 100%;
                    color:#999999;
                    font-size: 0.26rem;
                    text-align: center;
                    span{
                        align-self: center;
                        width: 1.73rem;
                        border-top: 1px solid #D9D9D9;
                    }
                }
            }
        }
        .wrapper{
            position:relative;
            width: 9.5rem;
            height: 1.7rem;
            padding: 0.32rem;
        }
        .note{
            display: flex;
            justify-content: space-between;
        }
        .main{
            align-self: center
        }
        .company{
            color: #484848!important;
            font-size: 0.37rem!important;
            margin-bottom: 0.22rem!important;
            margin-left: 0!important;
        }
        .address{
            font-size: 0.34rem!important;
            color:#6B6B6B!important;
            margin: 0!important
        }
        .goMap{
            width: 0.18rem;
            align-self: center;
        }
    </style>
</head>
<body>
<div id="wrapper">
    <div v-show="initialize">
        <div class="line"></div>
        <header style="display: none" v-show="initialize" @click="clickCompanyDetails">
            <span class="avatar">
                <img :src="this.detail.snapshot.company.logo_path" alt="">
            </span>
            <span class="contain">
                <p class="c-name">{{this.detail.snapshot.company.company_name}}</p>
            <span class="credit" v-if="this.detail.company.reputation">
                <span>信用</span>
                <div>
                    <img v-if="level>0" id="level" v-for="item in level" :src="level1" alt="" >
                </div>
            </span>
            </span>
            <span class="icon-footer">
                <img src="../images/icon_return@2x.png" alt="">
            </span>
        </header>
        <div style="height: 0.24rem;background: #F5F5F6;"><br/></div>
        <div class="line"></div>
        <div class="detail">
            <span>当前内容为订单快照,包含创建时的描述</span>
            <span @click="clickTaskDetails">点击查看最新内容</span>
        </div>
        <div class="line"></div>
        <div id="sale-task" v-show="initialize" v-if="this.detail.payment_method === 1">
            <div>
                <div class="task">
                    <span class="task-name">{{this.detail.task_title}}</span>
                    <span class="unit">{{this.detail.payment_money}}<span>{{this.detail.unit}}</span></span>
                    <span class="label">
                        <ul>
                            <li>即结</li>
                            <li>签合同</li>
                        </ul>
                    </span>
                </div>
                <div class="line" style="margin: 0 0.53rem;"></div>
                <div class="require">
                    <p>招募人数：<span>{{this.detail.snapshot.quantity_max}}</span></p>
                    <p>工作城市：<span>{{this.detail.snapshot.city.city_name}}</span></p>
                    <div>适合行业：<ul><li v-for="item in this.detail.industry">{{item.name}}<span>/</span></li></ul></div>
                </div>
                <div class="line" style="margin:0 0.53rem;"></div>
                <div class="product">
                    <span>产品描述</span>
                    <div>产品名称：{{this.detail.goods.goods_title}}</div>
                    <div style="margin-bottom: 0.53rem">产品价格：{{this.detail.goods.goods_price}}</div>
                    <p style="margin-bottom: 0.72rem">{{this.detail.goods.description}}</p>
                </div>
                <div class="line" style="margin:0 0.53rem;"></div>
                <div class="describe" v-if="this.detail.snapshot.video">
                    <span>产品视频</span>
                    <div style="text-align: center;margin-top: 0.66rem;position: relative">
                        <video id="video" width="70%" style="border-radius: 0.33rem" controls webkit-playsinline="true" playsinline x5-video-player-type="h5" :poster="this.detail.snapshot.video.cover">
                            <source :src="this.detail.snapshot.video.file_path">
                        </video>
                    </div>
                </div>
                <div class="line" style="margin:0 0.53rem;"></div>
                <div class="describe">
                    <span>产品图片</span>
                    <ul style="width: 100%;margin-top: 0.66rem;">
                        <li style="display: inline-block" v-for="item in this.detail.snapshot.images"><img :src="item.file_path" alt="" style="width: 2.8rem;margin-right: 0.16rem"></li>
                    </ul>
                </div>
                <div class="bottom">
                    <span></span>
                    <p style="display:inline-block;vertical-align:middle;align-self: center;margin: 0 0.34rem">已经到底啦，再往上逛逛吧</p>
                    <span></span>
                </div>
            </div>
        </div>
        <div id="job-task" v-show="initialize" v-if="this.detail.payment_method !== 1">
            <div style="position: relative">
                <div class="task">
                    <span class="task-name">{{this.detail.task_title}}</span>
                    <span class="unit">{{this.detail.payment_money}}<span>{{this.detail.unit}}</span></span>
                    <span class="label"><ul>
                        <li>完工结</li>
                        <li>有定金</li>
                        <li>签合同</li>
                    </ul></span>
                </div>
                <div class="line" style="margin: 0 0.53rem;"></div>
                <div class="require">
                    <p>招募人数：<span>{{this.detail.snapshot.quantity_max}}</span></p>
                    <p>工作城市：<span>{{this.detail.snapshot.city.city_name}}</span></p>
                    <div>适合行业：<ul><li v-for="item in this.detail.industry">{{item.name}}<span>/</span></li></ul></div>
                </div>
                <div class="line" style="margin:0 0.53rem;"></div>
                <div class="describe">
                    <span>工作描述</span>
                    <p style="color:#333333;line-height: 0.69rem;font-size: 0.37rem">
                        {{this.detail.snapshot.description}}
                    </p>
                </div>
                <div class="line" style="margin:0 0.53rem;"></div>
                <div class="map">
                    <p>工作地址</p>
                    <div style="margin: 0 0.29rem 0.37rem 0.53rem">
                        <img src="../images/didian2@2x.png" alt="" style="width: 0.34rem;">
                        <span>{{this.detail.snapshot.address}}</span>
                    </div>
                    <div v-if="this.detail.snapshot.latitude && this.detail.snapshot.longitude" id="mapContainer" style="height: 7rem;" @click="clickCompanyToAMap"></div>
                </div>
                <div class="bottom" style="">
                    <span></span>
                    <p style="display:inline-block;vertical-align:middle;align-self: center;margin: 0 0.34rem">已经到底啦，再往上逛逛吧</p>
                    <span></span>
                </div>
            </div>
        </div>
    </div>

</div>
</body>
<script src="../js/vue.js"></script>
<script src="../js/axios.min.js"></script>
<script src="../js/muse-ui.js"></script>
<script src="../js/less.min.js"></script>
<script>
    var vue = new Vue({
        el: '#wrapper',
        data:{
            detail:{},
            describeList: [
                {label: "即结",id:'1'},
                {label: "有定金",id:'2'},
                {label: "签合同",id:'3'},
            ],
            initialize: false,
            level:0,
            level1:"../images/x.png",
            level2:"../images/z.png",
            level3:"../images/mission3@2x.png",
            level4:"../images/mission@2x.png",
            openSimple: false,
            bigImg: '',
        },
        mounted(){
            setTimeout(function () {
                this.initialize = true;
            }.bind(this));
            if(this.detail.payment_method !== 1){
                this.init();
            }

        },
        methods:{
            clickCompanyDetails(){
                window.webkit.messageHandlers.aaa.postMessage(this.detail.snapshot.company.company_id);
            },
            clickCompanyToAMap(){
                window.webkit.messageHandlers.aaa.postMessage()
            },
            clickTaskDetails(){
                window.webkit.messageHandlers.aaa.postMessage(this.detail.task_id)
            },
            openSimpleDialog (img) {
                this.openSimple = true;
                this.bigImg = img
            },
            leveling(){
                var img = document.getElementById('level');
                if(this.detail.company.reputation){
                    if(4 <= this.detail.company.reputation && this.detail.company.reputation <= 10){
                        this.level = 1;
                        img.src = this.level1
                    }
                    if(11 <= this.detail.company.reputation && this.detail.company.reputation <= 40){
                        this.level = 2;
                        img.src = this.level1
                    }
                    if(41 <= this.detail.company.reputation && this.detail.company.reputation <= 90){
                        this.level = 3;
                        img.src = this.level1
                    }
                    if(91 <= this.detail.company.reputation && this.detail.company.reputation <= 150){
                        this.level = 4;
                        img.src = this.level1
                    }
                    if(151 <= this.detail.company.reputation && this.detail.company.reputation <= 250){
                        this.level = 5;
                        img.src = this.level1
                    }
                    if(251 <= this.detail.company.reputation && this.detail.company.reputation <= 500){
                        this.level = 1;
                        img.src = this.level2
                    }
                    if(501 <= this.detail.company.reputation && this.detail.company.reputation <= 1000){
                        this.level = 2;
                        img.src = this.level2
                    }
                    if(1001 <= this.detail.company.reputation && this.detail.company.reputation <= 2000){
                        this.level = 3;
                        img.src = this.level2
                    }
                    if(2001 <= this.detail.company.reputation && this.detail.company.reputation <= 5000){
                        this.level = 4;
                        img.src = this.level2
                    }
                    if(5001 <= this.detail.company.reputation && this.detail.company.reputation <= 10000){
                        this.level = 5;
                        img.src = this.level2
                    }
                    if(10001 <= this.detail.company.reputation && this.detail.company.reputation <= 20000){
                        this.level = 1;
                        img.src = this.level3
                    }
                    if(20001 <= this.detail.company.reputation && this.detail.company.reputation <= 50000){
                        this.level = 2;
                        img.src = this.level3
                    }
                    if(50001 <= this.detail.company.reputation && this.detail.company.reputation <= 100000){
                        this.level = 3;
                        img.src = this.level3
                    }
                    if(100001 <= this.detail.company.reputation && this.detail.company.reputation <= 200000){
                        this.level = 4;
                        img.src = this.level3
                    }
                    if(200001 <= this.detail.company.reputation && this.detail.company.reputation <= 500000){
                        this.level = 5;
                        img.src = this.level3
                    }
                    if(500001 <= this.detail.company.reputation && this.detail.company.reputation <= 1000000){
                        this.level = 1;
                        img.src = this.level4
                    }
                    if(1000001 <= this.detail.company.reputation && this.detail.company.reputation <= 2000000){
                        this.level = 2;
                        img.src = this.level4
                    }
                    if(2000001 <= this.detail.company.reputation && this.detail.company.reputation <= 5000000){
                        this.level = 3;
                        img.src = this.level4
                    }
                    if(5000001 <= this.detail.company.reputation && this.detail.company.reputation <= 10000000){
                        this.level = 4;
                        img.src = this.level4
                    }
                    if(this.detail.company.reputation > 1000000){
                        this.level = 5;
                        img.src = this.level4
                    }
                }
            },
            init(){
                var longitude = this.detail.snapshot.longitude;
                var latitude = this.detail.snapshot.latitude;
                var name = this.detail.snapshot.company.company_name;
                var area = this.detail.snapshot.address;
                var map = new AMap.Map('mapContainer', {
                    zoom: 15,
                    center:[longitude,latitude],
                    offset: new AMap.Pixel(0, 0),
                    dragEnable:false,
                    zoomEnable:false
                });
                var img = '<img style="width: 100%" src="../images/icon_return@2x.png" alt="">';
                var triangle = '<div style="position: absolute;bottom: -0.45rem; left: 50%;transform: translateX(-70%);border: 0.2rem solid transparent;border-top: 0.2rem solid #fff;"></div>';
                function createInfoWindow(img,triangle,name,area){
                    var info = document.createElement('div');
                    var wrapper = document.createElement('div');
                    wrapper.className = 'wrapper';
                    var note = document.createElement('div');
                    note.className = 'note';
                    var main = document.createElement('div');
                    main.className = 'main';
                    var company = document.createElement('p');
                    company.className = 'company';
                    company.innerHTML = name;
                    main.appendChild(company);
                    var address = document.createElement('p');
                    address.className = 'address';
                    address.innerHTML = area;
                    main.appendChild(address);
                    note.appendChild(main);
                    var goMap = document.createElement('div');
                    goMap.className = 'goMap';
                    goMap.innerHTML = img;
                    note.appendChild(goMap);
                    wrapper.innerHTML = triangle;
                    wrapper.appendChild(note);
                    info.appendChild(wrapper);
                    return info.innerHTML
                }
                // 创建一个自定义内容的 infowindow 实例
                marker = new AMap.Marker({
                    map:map,
                    position:[longitude,latitude],
                    label: {
                        offset: new AMap.Pixel(-169, -77),//修改label相对于maker的位置
                        content: createInfoWindow(img,triangle,name,area)
                    }
                });
            }
        },
        watch:{
            detail:function () {
                this.$nextTick(function(){
                    if(this.detail.payment_method !== 1){
                        this.init();
                    }
                    vue.leveling();
                });
            }
        }
    });

    function showInfoFromJava(item) {
        vue.detail = JSON.parse(item);
    }
    /*if(vue.detail){
        function taskDataLoading(){
            Javascript:aaa.taskDataLoading()
        }
        this.taskDataLoading()
    };*/
</script>
</html>